---
import { getCollection } from 'astro:content';
import { useTranslations } from '@i18n/utils';

const lang = Astro.currentLocale || 'fr';
const { t } = useTranslations(lang as 'fr' | 'en');

// Fetch featured projects from Content Collections
const collectionName = lang === 'en' ? 'projects-en' : 'projects-fr';
const allProjects = await getCollection(collectionName);
const featuredProjects = allProjects
  .filter(project => project.data.featured && project.data.published)
  .sort((a, b) => (a.data.order || 0) - (b.data.order || 0))
  .slice(0, 3);

// Category icons and colors
const categoryConfig: Record<string, { icon: string; color: string; label: string }> = {
  'web-development': {
    icon: 'code',
    color: '#0ea5e9',
    label: lang === 'en' ? 'Web Dev' : 'Dév Web'
  },
  'process-automation': {
    icon: 'zap',
    color: '#8b5cf6',
    label: lang === 'en' ? 'Automation' : 'Automatisation'
  },
  'data-analysis': {
    icon: 'chart',
    color: '#06b6d4',
    label: lang === 'en' ? 'Data Analysis' : 'Analyse Données'
  },
  'mobile-app': {
    icon: 'mobile',
    color: '#10b981',
    label: lang === 'en' ? 'Mobile App' : 'App Mobile'
  }
};

// SVG Icons for categories
const categoryIcons: Record<string, string> = {
  'code': 'M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4',
  'zap': 'M13 2L3 14h8l-1 8 10-12h-8l1-8z',
  'chart': 'M3 3v18h18M7 16l4-4 4 4 6-6',
  'mobile': 'M12 18h.01M8 2h8a2 2 0 012 2v16a2 2 0 01-2 2H8a2 2 0 01-2-2V4a2 2 0 012-2z'
};
---

<section class="relative py-16 md:py-24 bg-background overflow-hidden" id="featured-projects">
  <!-- Cyber Grid Background -->
  <div class="cyber-grid-light"></div>

  <div class="container-custom relative z-10">
    <!-- Section Header -->
    <div class="text-center max-w-3xl mx-auto mb-12 fade-in-scroll">
      <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-cyan-500/30 backdrop-blur-sm mb-4">
        <span class="pulse-dot"></span>
        <span class="text-xs font-mono text-cyan-500 uppercase tracking-widest">{t('projects.badge')}</span>
      </div>
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-6 text-foreground font-mono">
        {t('projects.featured_title')}
      </h2>
      <p class="text-sm md:text-base text-muted-foreground font-mono leading-relaxed max-w-2xl mx-auto">
        Real-world solutions delivering measurable impact across web development, automation, and data analytics
      </p>
    </div>

    <!-- Projects Grid - Category-Specific Layouts -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 mb-12">
      {featuredProjects.map((project, index) => {
        const projectUrl = lang === 'en' ? `/en/project/${project.slug}` : `/projet/${project.slug}`;
        const config = categoryConfig[project.data.category] || categoryConfig['web-development'];
        const categoryIcon = categoryIcons[config.icon] || categoryIcons['code'];

        // Determine visualization type based on category
        const isWebProject = ['web-development', 'mobile-app'].includes(project.data.category);
        const isDataProject = project.data.category === 'data-analysis';
        const isAutomationProject = project.data.category === 'process-automation';

        return (
          <div
            class="project-card-compact fade-in-scroll"
            style={`animation-delay: ${index * 150}ms`}
            data-project-id={project.slug}
          >
            {isWebProject ? (
              <!-- WEB/MOBILE PROJECT LAYOUT -->
              <div class="card-hover-glow card-border-glow-hover relative h-full rounded-xl p-[1px] overflow-hidden group">
                <!-- Gradient Border -->
                <div class="absolute inset-0 rounded-xl bg-gradient-to-b from-grey-30/60 via-grey-25/30 to-transparent"></div>

                <!-- Card Content -->
                <div class="relative h-full rounded-xl bg-background overflow-hidden">
                  <!-- Header -->
                <div class="p-6 border-b border-border/30">
                  <div class="flex items-start justify-between gap-4 mb-4">
                    <div class="cyber-badge inline-flex items-center gap-2 px-3 py-1.5 rounded border border-cyan-500/30 bg-cyan-500/10">
                      <svg class="w-3.5 h-3.5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <path d={categoryIcon} stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                      <span class="text-xs font-mono text-cyan-400 uppercase tracking-wider">{config.label}</span>
                    </div>
                    <div class="px-2 py-1 rounded border border-border/30 bg-background/50">
                      <span class="text-xs font-mono text-muted-foreground uppercase">Live</span>
                    </div>
                  </div>
                  <h3 class="text-xl md:text-2xl font-bold text-foreground mb-2 font-mono group-hover:text-cyan-500 transition-colors line-clamp-2">
                    {project.data.title}
                  </h3>
                  <p class="text-sm text-cyan-500/70 font-mono">
                    <span class="text-muted-foreground">client://</span>{project.data.client}
                  </p>
                </div>

                <!-- Dual Device Preview -->
                <div class="preview-section relative bg-background py-3 px-4">
                  <div class="devices-showcase relative">
                    <!-- Desktop Browser (larger, in back) -->
                    <div class="browser-showcase rounded-lg border border-border overflow-hidden bg-grey-20 shadow-lg">
                      <div class="browser-bar flex items-center gap-2 px-3 py-2 border-b border-border/50 bg-grey-25">
                        <div class="flex gap-1.5">
                          <div class="w-2 h-2 rounded-full bg-red-500/80"></div>
                          <div class="w-2 h-2 rounded-full bg-yellow-500/80"></div>
                          <div class="w-2 h-2 rounded-full bg-green-500/80"></div>
                        </div>
                      </div>
                      <div class="aspect-[16/7] overflow-hidden">
                        <img src={project.data.image || '/images/project-placeholder.jpg'} alt={project.data.title} class="w-full h-full object-cover object-top"/>
                      </div>
                    </div>

                    <!-- Mobile Phone (smaller, overlapping on right) -->
                    <div class="phone-showcase absolute -bottom-3 -right-2 w-36 z-10">
                      <div class="bg-grey-20 rounded-[2rem] p-2 border-2 border-grey-25 shadow-2xl">
                        <div class="relative bg-grey-10 rounded-[1.5rem] overflow-hidden aspect-[9/19]">
                          <div class="absolute top-0 left-1/2 -translate-x-1/2 w-1/3 h-4 bg-grey-20 rounded-b-xl z-10"></div>
                          <img src={project.data.mobileImage || project.data.image || '/images/project-placeholder.jpg'} alt={`${project.data.title} mobile`} class="w-full h-full object-cover object-top"/>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Content -->
                <div class="p-6">
                  <p class="text-sm text-muted-foreground font-mono leading-relaxed mb-4 line-clamp-2">
                    {project.data.description}
                  </p>
                  {project.data.results && project.data.results.length > 0 && (
                    <div class="flex gap-4 mb-4 pb-4 border-b border-border/30">
                      {project.data.results.slice(0, 2).map((result: any) => (
                        <div class="flex-1">
                          <div class="text-lg font-bold font-mono text-cyan-500">{result.value}</div>
                          <div class="text-xs text-muted-foreground font-mono uppercase tracking-wider line-clamp-1">{result.metric}</div>
                        </div>
                      ))}
                    </div>
                  )}
                  <div class="mb-4">
                    <div class="flex flex-wrap gap-1.5">
                      {project.data.technologies.slice(0, 4).map((tech: string) => (
                        <span class="tech-tag-mini px-2 py-1 text-xs font-mono rounded border border-border/30 bg-background/30 text-muted-foreground">
                          {tech}
                        </span>
                      ))}
                      {project.data.technologies.length > 4 && (
                        <span class="tech-tag-mini px-2 py-1 text-xs font-mono rounded border border-border/30 bg-background/30 text-muted-foreground/80">
                          +{project.data.technologies.length - 4}
                        </span>
                      )}
                    </div>
                  </div>
                  <a href={projectUrl} class="scramble-btn inline-flex items-center gap-2 px-5 py-2.5 bg-cyan-500 hover:bg-cyan-400 text-white text-sm font-bold font-mono uppercase tracking-wider transition-all duration-300 clip-corner-btn-sm group/btn w-full justify-center">
                    <span class="scramble-text" data-text={t('projects.view_case_study')}>{t('projects.view_case_study')}</span>
                    <svg class="w-4 h-4 transition-transform group-hover/btn:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                  </a>
                </div>
                </div>
              </div>
            ) : isDataProject ? (
              <!-- DATA ANALYSIS PROJECT LAYOUT -->
              <div class="card-hover-glow card-border-glow-hover relative h-full rounded-xl p-[1px] overflow-hidden group">
                <!-- Gradient Border -->
                <div class="absolute inset-0 rounded-xl bg-gradient-to-b from-grey-30/60 via-grey-25/30 to-transparent"></div>

                <!-- Card Content -->
                <div class="relative h-full rounded-xl bg-background overflow-hidden">
                  <!-- Horizontal Layout: Info Left, Viz Right -->
                  <div class="flex flex-col md:flex-row h-full">
                  <!-- Left: Info -->
                  <div class="flex-1 p-6 flex flex-col">
                    <div class="cyber-badge inline-flex items-center gap-2 px-3 py-1.5 rounded border border-cyan-500/30 bg-cyan-500/10 w-fit mb-4">
                      <svg class="w-3.5 h-3.5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <path d={categoryIcon} stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                      <span class="text-xs font-mono text-cyan-400 uppercase tracking-wider">{config.label}</span>
                    </div>

                    <h3 class="text-xl font-bold text-foreground mb-2 font-mono group-hover:text-cyan-500 transition-colors">
                      {project.data.title}
                    </h3>
                    <p class="text-sm text-cyan-500/70 font-mono mb-4">
                      <span class="text-muted-foreground">client://</span>{project.data.client}
                    </p>

                    <p class="text-sm text-muted-foreground font-mono leading-relaxed mb-4 flex-grow">
                      {project.data.description}
                    </p>

                    {project.data.results && project.data.results.length > 0 && (
                      <div class="grid grid-cols-2 gap-3 mb-4 p-4 rounded-lg border border-border/30 bg-grey-20/50">
                        {project.data.results.slice(0, 4).map((result: any) => (
                          <div class="text-center">
                            <div class="text-xl font-bold font-mono text-cyan-500 mb-1">{result.value}</div>
                            <div class="text-[10px] text-muted-foreground font-mono uppercase tracking-wider line-clamp-1">{result.metric}</div>
                          </div>
                        ))}
                      </div>
                    )}

                    <a href={projectUrl} class="scramble-btn inline-flex items-center gap-2 px-5 py-2.5 bg-cyan-500 hover:bg-cyan-400 text-white text-sm font-bold font-mono uppercase tracking-wider transition-all duration-300 clip-corner-btn-sm group/btn w-full justify-center mt-auto">
                      <span class="scramble-text" data-text={t('projects.view_analysis')}>{t('projects.view_analysis')}</span>
                      <svg class="w-4 h-4 transition-transform group-hover/btn:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                      </svg>
                    </a>
                  </div>

                  <!-- Right: Data Visualization -->
                  <div class="flex-1 bg-background p-6 flex items-center justify-center border-l border-border/30">
                    <div class="w-full space-y-4">
                      <!-- Chart Title -->
                      <div class="text-center text-xs font-mono text-cyan-500 uppercase tracking-wider">Performance Metrics</div>

                      <!-- Bar Chart -->
                      <div class="flex items-end justify-between gap-3 h-28">
                        <div class="flex-1 bg-gradient-to-t from-cyan-500 to-cyan-500/40 rounded-t transition-all duration-500 hover:from-cyan-400" style="height: 65%"></div>
                        <div class="flex-1 bg-gradient-to-t from-cyan-500 to-cyan-500/40 rounded-t transition-all duration-500 hover:from-cyan-400" style="height: 88%"></div>
                        <div class="flex-1 bg-gradient-to-t from-cyan-500 to-cyan-500/40 rounded-t transition-all duration-500 hover:from-cyan-400" style="height: 52%"></div>
                        <div class="flex-1 bg-gradient-to-t from-cyan-500 to-cyan-500/40 rounded-t transition-all duration-500 hover:from-cyan-400" style="height: 95%"></div>
                        <div class="flex-1 bg-gradient-to-t from-cyan-500 to-cyan-500/40 rounded-t transition-all duration-500 hover:from-cyan-400" style="height: 73%"></div>
                      </div>

                      <!-- Tech Stack Below -->
                      <div class="flex flex-wrap gap-1.5 justify-center pt-4 border-t border-border/30">
                        {project.data.technologies.slice(0, 3).map((tech: string) => (
                          <span class="tech-tag-mini px-2 py-1 text-xs font-mono rounded border border-border/30 bg-background/30 text-muted-foreground">
                            {tech}
                          </span>
                        ))}
                      </div>
                    </div>
                  </div>
                  </div>
                </div>
              </div>
            ) : isAutomationProject ? (
              <!-- AUTOMATION PROJECT LAYOUT -->
              <div class="card-hover-glow card-border-glow-hover relative h-full rounded-xl p-[1px] overflow-hidden group">
                <!-- Gradient Border -->
                <div class="absolute inset-0 rounded-xl bg-gradient-to-b from-grey-30/60 via-grey-25/30 to-transparent"></div>

                <!-- Card Content -->
                <div class="relative h-full rounded-xl bg-background overflow-hidden">
                  <!-- Horizontal Layout: Info Left, Process Flow Right -->
                  <div class="flex flex-col md:flex-row h-full">
                  <!-- Left: Info -->
                  <div class="flex-1 p-6 flex flex-col">
                    <div class="cyber-badge inline-flex items-center gap-2 px-3 py-1.5 rounded border border-cyan-500/30 bg-cyan-500/10 w-fit mb-4">
                      <svg class="w-3.5 h-3.5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                        <path d={categoryIcon} stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                      <span class="text-xs font-mono text-cyan-400 uppercase tracking-wider">{config.label}</span>
                    </div>

                    <h3 class="text-xl font-bold text-foreground mb-2 font-mono group-hover:text-cyan-500 transition-colors">
                      {project.data.title}
                    </h3>
                    <p class="text-sm text-cyan-500/70 font-mono mb-4">
                      <span class="text-muted-foreground">client://</span>{project.data.client}
                    </p>

                    <p class="text-sm text-muted-foreground font-mono leading-relaxed mb-4 flex-grow">
                      {project.data.description}
                    </p>

                    {project.data.results && project.data.results.length > 0 && (
                      <div class="grid grid-cols-2 gap-3 mb-4 p-4 rounded-lg border border-border/30 bg-grey-20/50">
                        {project.data.results.slice(0, 4).map((result: any) => (
                          <div class="text-center">
                            <div class="text-xl font-bold font-mono text-cyan-500 mb-1">{result.value}</div>
                            <div class="text-[10px] text-muted-foreground font-mono uppercase tracking-wider line-clamp-1">{result.metric}</div>
                          </div>
                        ))}
                      </div>
                    )}

                    <a href={projectUrl} class="scramble-btn inline-flex items-center gap-2 px-5 py-2.5 bg-cyan-500 hover:bg-cyan-400 text-white text-sm font-bold font-mono uppercase tracking-wider transition-all duration-300 clip-corner-btn-sm group/btn w-full justify-center mt-auto">
                      <span class="scramble-text" data-text={t('projects.view_solution')}>{t('projects.view_solution')}</span>
                      <svg class="w-4 h-4 transition-transform group-hover/btn:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                      </svg>
                    </a>
                  </div>

                  <!-- Right: Process Flow Diagram -->
                  <div class="flex-1 bg-background p-6 flex items-center justify-center border-l border-border/30">
                    <div class="w-full space-y-4">
                      <!-- Flow Title -->
                      <div class="text-center text-xs font-mono text-cyan-500 uppercase tracking-wider mb-4">Our Approach</div>

                      <!-- Process Flow Boxes -->
                      <div class="space-y-3">
                        <!-- Analysis -->
                        <div class="process-box p-3 rounded-lg border border-border bg-grey-20/50 transition-all duration-300 hover:border-cyan-500/50">
                          <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded bg-cyan-500/20 flex items-center justify-center flex-shrink-0">
                              <svg class="w-5 h-5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                              </svg>
                            </div>
                            <div class="flex-1">
                              <div class="text-xs font-mono text-foreground font-semibold">Analysis</div>
                              <div class="text-xs text-muted-foreground/70">Process Discovery</div>
                            </div>
                          </div>
                        </div>

                        <!-- Arrow -->
                        <div class="flex justify-center">
                          <svg class="w-4 h-4 text-cyan-500" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
                          </svg>
                        </div>

                        <!-- Workflow Design -->
                        <div class="process-box p-3 rounded-lg border border-border bg-grey-20/50 transition-all duration-300 hover:border-cyan-500/50">
                          <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded bg-cyan-500/20 flex items-center justify-center flex-shrink-0">
                              <svg class="w-5 h-5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"/>
                              </svg>
                            </div>
                            <div class="flex-1">
                              <div class="text-xs font-mono text-foreground font-semibold">Design</div>
                              <div class="text-xs text-muted-foreground/70">Workflow Creation</div>
                            </div>
                          </div>
                        </div>

                        <!-- Arrow -->
                        <div class="flex justify-center">
                          <svg class="w-4 h-4 text-cyan-500" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
                          </svg>
                        </div>

                        <!-- Implementation -->
                        <div class="process-box p-3 rounded-lg border border-border bg-grey-20/50 transition-all duration-300 hover:border-cyan-500/50">
                          <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded bg-cyan-500/20 flex items-center justify-center flex-shrink-0">
                              <svg class="w-5 h-5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                              </svg>
                            </div>
                            <div class="flex-1">
                              <div class="text-xs font-mono text-foreground font-semibold">Implementation</div>
                              <div class="text-xs text-muted-foreground/70">Deployment & Testing</div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Tech Stack Below -->
                      <div class="flex flex-wrap gap-1.5 justify-center pt-4 border-t border-border/30">
                        {project.data.technologies.slice(0, 3).map((tech: string) => (
                          <span class="tech-tag-mini px-2 py-1 text-xs font-mono rounded border border-border/30 bg-background/30 text-muted-foreground">
                            {tech}
                          </span>
                        ))}
                      </div>
                    </div>
                  </div>
                  </div>
                </div>
              </div>
            ) : null}
          </div>
        );
      })}
    </div>

    <!-- View All Projects CTA -->
    <div class="text-center fade-in-scroll">
      <a href={lang === 'en' ? '/en/projects' : '/projets'} class="scramble-btn cyber-button-secondary clip-corner-lg group relative inline-flex items-center gap-3 px-8 py-4 font-mono font-bold uppercase tracking-wider border-2 border-border hover:border-cyan-500 transition-all duration-300">
        <span class="relative z-10 flex items-center gap-2">
          <span class="scramble-text" data-text={t('projects.all_projects')}>{t('projects.all_projects')}</span>
          <svg class="w-5 h-5 transition-transform group-hover:rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </span>
      </a>
    </div>
  </div>
</section>

<style>
  /* ============================================
     COMPACT PROJECT CARDS
     ============================================ */
  .project-card-compact {
    height: 100%;
  }

  /* ============================================
     WEB PROJECT - DUAL DEVICE SHOWCASE
     ============================================ */
  .devices-showcase {
    position: relative;
    padding-bottom: 1rem; /* Space for mobile overflow */
  }

  .browser-showcase {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  }

  .phone-showcase {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  }

  /* ============================================
     DATA ANALYSIS PROJECT - HORIZONTAL LAYOUT
     ============================================ */
  .data-analysis-layout {
    min-height: 350px;
  }

  /* ============================================
     AUTOMATION PROJECT - TERMINAL LAYOUT
     ============================================ */
  .automation-layout {
    min-height: 450px;
  }

  /* ============================================
     TECH TAGS
     ============================================ */
  .tech-tag-mini {
    backdrop-filter: blur(10px);
    transition: all 0.2s ease;
  }

  .tech-tag-mini:hover {
    border-color: rgba(14, 165, 233, 0.5);
    background: rgba(14, 165, 233, 0.1);
    color: rgba(14, 165, 233, 1);
  }

  /* ============================================
     CYBER BADGE
     ============================================ */
  .cyber-badge {
    backdrop-filter: blur(10px);
  }

  /* ============================================
     CLIP CORNER BUTTONS
     ============================================ */
  .clip-corner-btn-sm {
    clip-path: polygon(
      0 0,
      calc(100% - 8px) 0,
      100% 8px,
      100% 100%,
      0 100%
    );
  }

  .clip-corner-lg {
    clip-path: polygon(
      0 0,
      calc(100% - 12px) 0,
      100% 12px,
      100% 100%,
      0 100%
    );
  }

  /* ============================================
     PREVIEW SECTION
     ============================================ */
  .preview-section {
    min-height: 260px;
  }

  /* ============================================
     RESPONSIVE
     ============================================ */
  @media (max-width: 768px) {
    .preview-section {
      min-height: 220px;
    }

    .phone-showcase {
      width: 6rem !important;
      bottom: -1rem !important;
      right: -0.5rem !important;
    }

    /* Stack data analysis layout vertically on mobile */
    .data-analysis-layout .flex-col {
      flex-direction: column !important;
    }

    .data-analysis-layout .border-l {
      border-left: none !important;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
  }

  @media (max-width: 640px) {
    .devices-showcase {
      padding-bottom: 1rem;
    }

    .phone-showcase {
      width: 5rem !important;
      bottom: -0.75rem !important;
      right: -0.25rem !important;
    }
  }
</style>

<script>
  // Scroll animations handled by shared scroll-observer.ts
  import '@scripts/scroll-observer';

  // Scramble text effect
  function scrambleText(element: HTMLElement, finalText: string) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
    const duration = 600; // Shorter duration for button text
    const startTime = Date.now();

    function update() {
      const elapsed = Date.now() - startTime;
      const progress = Math.min(elapsed / duration, 1);

      let result = '';
      for (let i = 0; i < finalText.length; i++) {
        if (progress * finalText.length > i) {
          result += finalText[i];
        } else {
          result += chars[Math.floor(Math.random() * chars.length)];
        }
      }

      element.textContent = result;

      if (progress < 1) {
        requestAnimationFrame(update);
      } else {
        element.textContent = finalText;
      }
    }

    update();
  }

  // Add scramble effect on hover to all buttons
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.scramble-btn').forEach(button => {
      button.addEventListener('mouseenter', () => {
        const textEl = button.querySelector('.scramble-text') as HTMLElement;
        if (textEl) {
          const text = textEl.getAttribute('data-text') || '';
          scrambleText(textEl, text);
        }
      });
    });
  });
</script>
