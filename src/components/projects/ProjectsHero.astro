---
import { useTranslations } from '@i18n/utils';

const lang = Astro.currentLocale || 'fr';
const { t } = useTranslations(lang as 'fr' | 'en');
---

<section class="relative min-h-[400px] py-16 md:py-20 flex items-center justify-center overflow-hidden bg-background" style="scroll-snap-align: start;">
  <!-- Cyber Grid Background -->
  <div class="cyber-grid"></div>

  <!-- Scan Lines -->
  <div class="scan-lines"></div>

  <!-- Content Container -->
  <div class="container-custom relative z-10 h-full flex items-center">
    <div class="max-w-4xl mx-auto w-full text-center">
      <!-- Badge -->
      <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-cyan-500/30 backdrop-blur-sm mb-6 fade-in-scroll">
        <span class="pulse-dot"></span>
        <span class="text-xs md:text-sm font-mono text-cyan-500 uppercase tracking-widest">{t('projects.badge')}</span>
      </div>

      <!-- Hero Title -->
      <h1 id="projects-hero-title" class="text-shimmer text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold tracking-tight leading-tight mb-6 fade-in-scroll" data-text={t('projects.title')}>
        {t('projects.title')}
      </h1>

      <!-- Subtitle -->
      <p class="text-base sm:text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto font-mono leading-relaxed fade-in-scroll">
        {t('projects.subtitle')}
      </p>

      <!-- Stats Grid -->
      <div class="stats-grid grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 md:gap-6 max-w-3xl mx-auto pt-8 md:pt-10 fade-in-scroll">
        <div class="stat-item text-center p-4 rounded-lg border border-border/30 bg-background/30 backdrop-blur-sm">
          <div class="stat-number glow-cyan text-2xl sm:text-3xl md:text-4xl font-bold font-mono text-cyan-500 mb-2">
            <span>150</span>
            <span class="plus text-xl md:text-2xl">+</span>
          </div>
          <div class="text-[10px] sm:text-xs text-muted-foreground font-mono uppercase tracking-wider">
            {lang === 'en' ? 'Projects' : 'Projets'}
          </div>
        </div>

        <div class="stat-item text-center p-4 rounded-lg border border-border/30 bg-background/30 backdrop-blur-sm">
          <div class="stat-number glow-cyan text-2xl sm:text-3xl md:text-4xl font-bold font-mono text-cyan-500 mb-2">
            <span>98</span>
            <span class="percent text-xl md:text-2xl">%</span>
          </div>
          <div class="text-[10px] sm:text-xs text-muted-foreground font-mono uppercase tracking-wider">
            {lang === 'en' ? 'Success' : 'Succ√®s'}
          </div>
        </div>

        <div class="stat-item text-center p-4 rounded-lg border border-border/30 bg-background/30 backdrop-blur-sm">
          <div class="stat-number glow-cyan text-2xl sm:text-3xl md:text-4xl font-bold font-mono text-cyan-500 mb-2">
            <span>50</span>
            <span class="plus text-xl md:text-2xl">+</span>
          </div>
          <div class="text-[10px] sm:text-xs text-muted-foreground font-mono uppercase tracking-wider">
            {lang === 'en' ? 'Clients' : 'Clients'}
          </div>
        </div>

        <div class="stat-item text-center p-4 rounded-lg border border-border/30 bg-background/30 backdrop-blur-sm">
          <div class="stat-number glow-cyan text-2xl sm:text-3xl md:text-4xl font-bold font-mono text-cyan-500 mb-2">
            <span>15</span>
            <span class="plus text-xl md:text-2xl">+</span>
          </div>
          <div class="text-[10px] sm:text-xs text-muted-foreground font-mono uppercase tracking-wider">
            {lang === 'en' ? 'Industries' : 'Secteurs'}
          </div>
        </div>
      </div>

      <!-- Terminal-style tagline -->
      <div class="terminal-line font-mono text-xs md:text-sm text-muted-foreground/60 pt-6 fade-in-scroll">
        <span class="terminal-prompt">$</span>
        <span class="terminal-cursor">showcase --portfolio --category=all</span>
      </div>
    </div>
  </div>

  <!-- Floating Particles -->
  <div class="particles-container">
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
  </div>
</section>

<style>
  .particles-container {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: #0ea5e9;
    border-radius: 50%;
    box-shadow: 0 0 10px #0ea5e9;
    opacity: 0;
    animation: particleFloat 8s ease-in-out infinite;
  }

  .particle:nth-child(1) {
    left: 20%;
    animation-delay: 0s;
    animation-duration: 6s;
  }

  .particle:nth-child(2) {
    left: 50%;
    animation-delay: 1.5s;
    animation-duration: 7s;
  }

  .particle:nth-child(3) {
    left: 80%;
    animation-delay: 3s;
    animation-duration: 8s;
  }

  @keyframes particleFloat {
    0% {
      opacity: 0;
      transform: translateY(100vh);
    }
    10% {
      opacity: 1;
    }
    90% {
      opacity: 1;
    }
    100% {
      opacity: 0;
      transform: translateY(-20vh);
    }
  }

  .stat-item {
    transition: all 0.3s ease;
  }

  .stat-item:hover {
    border-color: rgba(6, 182, 212, 0.5);
    background: rgba(6, 182, 212, 0.1);
    transform: translateY(-2px);
  }
</style>

<script>
  // Simple scramble effect
  function scrambleText(element: HTMLElement, finalText: string) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
    const duration = 1000;
    const startTime = Date.now();

    element.style.whiteSpace = 'normal';
    element.style.overflowWrap = 'break-word';
    element.style.overflowWrap = 'break-word';

    function update() {
      const elapsed = Date.now() - startTime;
      const progress = Math.min(elapsed / duration, 1);

      let result = '';
      for (let i = 0; i < finalText.length; i++) {
        if (progress * (finalText.length + 1) > i) {
          result += finalText[i];
        } else {
          result += chars[Math.floor(Math.random() * chars.length)];
        }
      }

      element.textContent = result;

      if (progress < 1) {
        requestAnimationFrame(update);
      } else {
        element.textContent = finalText;
      }
    }

    update();
  }

  document.addEventListener('DOMContentLoaded', () => {
    const projectsTitle = document.getElementById('projects-hero-title') as HTMLElement;
    if (projectsTitle) {
      const text = projectsTitle.getAttribute('data-text') || '';
      scrambleText(projectsTitle, text);
    }
  });
</script>
